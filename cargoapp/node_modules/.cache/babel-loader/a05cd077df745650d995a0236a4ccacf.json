{"ast":null,"code":"\"use strict\";\n\nrequire(\"core-js/modules/es.symbol.js\");\n\nrequire(\"core-js/modules/es.symbol.description.js\");\n\nrequire(\"core-js/modules/es.object.to-string.js\");\n\nrequire(\"core-js/modules/es.symbol.iterator.js\");\n\nrequire(\"core-js/modules/es.string.iterator.js\");\n\nrequire(\"core-js/modules/web.dom-collections.iterator.js\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = exports.ClickOutside = void 0;\n\nvar _dom = require(\"../../util/dom\");\n\nfunction _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") {\n    _typeof = function _typeof(obj) {\n      return typeof obj;\n    };\n  } else {\n    _typeof = function _typeof(obj) {\n      return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n    };\n  }\n\n  return _typeof(obj);\n}\n\nfunction defaultConditional() {\n  return true;\n}\n\nfunction checkEvent(e, el, binding) {\n  // The include element callbacks below can be expensive\n  // so we should avoid calling them when we're not active.\n  // Explicitly check for false to allow fallback compatibility\n  // with non-toggleable components\n  if (!e || checkIsActive(e, binding) === false) return false; // If we're clicking inside the shadowroot, then the app root doesn't get the same\n  // level of introspection as to _what_ we're clicking. We want to check to see if\n  // our target is the shadowroot parent container, and if it is, ignore.\n\n  var root = (0, _dom.attachedRoot)(el);\n  if (typeof ShadowRoot !== 'undefined' && root instanceof ShadowRoot && root.host === e.target) return false; // Check if additional elements were passed to be included in check\n  // (click must be outside all included elements, if any)\n\n  var elements = (_typeof(binding.value) === 'object' && binding.value.include || function () {\n    return [];\n  })(); // Add the root element for the component this directive was defined on\n\n\n  elements.push(el); // Check if it's a click outside our elements, and then if our callback returns true.\n  // Non-toggleable components should take action in their callback and return falsy.\n  // Toggleable can return true if it wants to deactivate.\n  // Note that, because we're in the capture phase, this callback will occur before\n  // the bubbling click event on any outside elements.\n\n  return !elements.some(function (el) {\n    return el.contains(e.target);\n  });\n}\n\nfunction checkIsActive(e, binding) {\n  var isActive = _typeof(binding.value) === 'object' && binding.value.closeConditional || defaultConditional;\n  return isActive(e);\n}\n\nfunction directive(e, el, binding, vnode) {\n  var handler = typeof binding.value === 'function' ? binding.value : binding.value.handler;\n  el._clickOutside.lastMousedownWasOutside && checkEvent(e, el, binding) && setTimeout(function () {\n    checkIsActive(e, binding) && handler && handler(e);\n  }, 0);\n}\n\nfunction handleShadow(el, callback) {\n  var root = (0, _dom.attachedRoot)(el);\n  callback(document);\n\n  if (typeof ShadowRoot !== 'undefined' && root instanceof ShadowRoot) {\n    callback(root);\n  }\n}\n\nvar ClickOutside = {\n  // [data-app] may not be found\n  // if using bind, inserted makes\n  // sure that the root element is\n  // available, iOS does not support\n  // clicks on body\n  inserted: function inserted(el, binding, vnode) {\n    var onClick = function onClick(e) {\n      return directive(e, el, binding, vnode);\n    };\n\n    var onMousedown = function onMousedown(e) {\n      el._clickOutside.lastMousedownWasOutside = checkEvent(e, el, binding);\n    };\n\n    handleShadow(el, function (app) {\n      app.addEventListener('click', onClick, true);\n      app.addEventListener('mousedown', onMousedown, true);\n    });\n\n    if (!el._clickOutside) {\n      el._clickOutside = {\n        lastMousedownWasOutside: true\n      };\n    }\n\n    el._clickOutside[vnode.context._uid] = {\n      onClick: onClick,\n      onMousedown: onMousedown\n    };\n  },\n  unbind: function unbind(el, binding, vnode) {\n    if (!el._clickOutside) return;\n    handleShadow(el, function (app) {\n      var _el$_clickOutside;\n\n      if (!app || !((_el$_clickOutside = el._clickOutside) != null && _el$_clickOutside[vnode.context._uid])) return;\n      var _el$_clickOutside$vno = el._clickOutside[vnode.context._uid],\n          onClick = _el$_clickOutside$vno.onClick,\n          onMousedown = _el$_clickOutside$vno.onMousedown;\n      app.removeEventListener('click', onClick, true);\n      app.removeEventListener('mousedown', onMousedown, true);\n    });\n    delete el._clickOutside[vnode.context._uid];\n  }\n};\nexports.ClickOutside = ClickOutside;\nvar _default = ClickOutside;\nexports.default = _default;","map":{"version":3,"mappings":"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","names":["defaultConditional","checkEvent","e","el","binding","checkIsActive","root","ShadowRoot","host","target","elements","_typeof","value","include","push","some","contains","isActive","closeConditional","directive","vnode","handler","_clickOutside","lastMousedownWasOutside","setTimeout","handleShadow","callback","document","ClickOutside","inserted","onClick","onMousedown","app","addEventListener","context","_uid","unbind","_el$_clickOutside","removeEventListener"],"sourceRoot":"","sources":["../../../src/directives/click-outside/index.ts"],"sourcesContent":["import { attachedRoot } from '../../util/dom'\nimport { VNodeDirective } from 'vue/types/vnode'\nimport { VNode } from 'vue'\n\ninterface ClickOutsideBindingArgs {\n  handler: (e: Event) => void\n  closeConditional?: (e: Event) => boolean\n  include?: () => HTMLElement[]\n}\n\ninterface ClickOutsideDirective extends VNodeDirective {\n  value?: ((e: Event) => void) | ClickOutsideBindingArgs\n}\n\nfunction defaultConditional () {\n  return true\n}\n\nfunction checkEvent (e: PointerEvent, el: HTMLElement, binding: ClickOutsideDirective): boolean {\n  // The include element callbacks below can be expensive\n  // so we should avoid calling them when we're not active.\n  // Explicitly check for false to allow fallback compatibility\n  // with non-toggleable components\n  if (!e || checkIsActive(e, binding) === false) return false\n\n  // If we're clicking inside the shadowroot, then the app root doesn't get the same\n  // level of introspection as to _what_ we're clicking. We want to check to see if\n  // our target is the shadowroot parent container, and if it is, ignore.\n  const root = attachedRoot(el)\n  if (\n    typeof ShadowRoot !== 'undefined' &&\n    root instanceof ShadowRoot &&\n    root.host === e.target\n  ) return false\n\n  // Check if additional elements were passed to be included in check\n  // (click must be outside all included elements, if any)\n  const elements = ((typeof binding.value === 'object' && binding.value.include) || (() => []))()\n  // Add the root element for the component this directive was defined on\n  elements.push(el)\n\n  // Check if it's a click outside our elements, and then if our callback returns true.\n  // Non-toggleable components should take action in their callback and return falsy.\n  // Toggleable can return true if it wants to deactivate.\n  // Note that, because we're in the capture phase, this callback will occur before\n  // the bubbling click event on any outside elements.\n  return !elements.some(el => el.contains(e.target as Node))\n}\n\nfunction checkIsActive (e: PointerEvent, binding: ClickOutsideDirective): boolean | void {\n  const isActive = (typeof binding.value === 'object' && binding.value.closeConditional) || defaultConditional\n\n  return isActive(e)\n}\n\nfunction directive (e: PointerEvent, el: HTMLElement, binding: ClickOutsideDirective, vnode: VNode) {\n  const handler = typeof binding.value === 'function' ? binding.value : binding.value!.handler\n\n  el._clickOutside!.lastMousedownWasOutside && checkEvent(e, el, binding) && setTimeout(() => {\n    checkIsActive(e, binding) && handler && handler(e)\n  }, 0)\n}\n\nfunction handleShadow (el: HTMLElement, callback: Function): void {\n  const root = attachedRoot(el)\n\n  callback(document)\n\n  if (typeof ShadowRoot !== 'undefined' && root instanceof ShadowRoot) {\n    callback(root)\n  }\n}\n\nexport const ClickOutside = {\n  // [data-app] may not be found\n  // if using bind, inserted makes\n  // sure that the root element is\n  // available, iOS does not support\n  // clicks on body\n  inserted (el: HTMLElement, binding: ClickOutsideDirective, vnode: VNode) {\n    const onClick = (e: Event) => directive(e as PointerEvent, el, binding, vnode)\n    const onMousedown = (e: Event) => {\n      el._clickOutside!.lastMousedownWasOutside = checkEvent(e as PointerEvent, el, binding)\n    }\n\n    handleShadow(el, (app: HTMLElement) => {\n      app.addEventListener('click', onClick, true)\n      app.addEventListener('mousedown', onMousedown, true)\n    })\n\n    if (!el._clickOutside) {\n      el._clickOutside = {\n        lastMousedownWasOutside: true,\n      }\n    }\n\n    el._clickOutside[vnode.context!._uid] = {\n      onClick,\n      onMousedown,\n    }\n  },\n\n  unbind (el: HTMLElement, binding: ClickOutsideDirective, vnode: VNode) {\n    if (!el._clickOutside) return\n\n    handleShadow(el, (app: HTMLElement) => {\n      if (!app || !el._clickOutside?.[vnode.context!._uid]) return\n\n      const { onClick, onMousedown } = el._clickOutside[vnode.context!._uid]!\n\n      app.removeEventListener('click', onClick, true)\n      app.removeEventListener('mousedown', onMousedown, true)\n    })\n\n    delete el._clickOutside[vnode.context!._uid]\n  },\n}\n\nexport default ClickOutside\n"]},"metadata":{},"sourceType":"script"}