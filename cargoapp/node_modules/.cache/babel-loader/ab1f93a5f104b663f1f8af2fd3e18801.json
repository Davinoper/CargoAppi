{"ast":null,"code":"\"use strict\";\n\nrequire(\"core-js/modules/es.object.keys.js\");\n\nrequire(\"core-js/modules/es.symbol.js\");\n\nrequire(\"core-js/modules/es.array.filter.js\");\n\nrequire(\"core-js/modules/es.object.to-string.js\");\n\nrequire(\"core-js/modules/es.object.get-own-property-descriptor.js\");\n\nrequire(\"core-js/modules/web.dom-collections.for-each.js\");\n\nrequire(\"core-js/modules/es.object.get-own-property-descriptors.js\");\n\nrequire(\"core-js/modules/es.number.constructor.js\");\n\nrequire(\"core-js/modules/es.math.sign.js\");\n\nrequire(\"core-js/modules/es.array.concat.js\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nrequire(\"../../../src/components/VTimePicker/VTimePickerClock.sass\");\n\nvar _colorable = _interopRequireDefault(require(\"../../mixins/colorable\"));\n\nvar _themeable = _interopRequireDefault(require(\"../../mixins/themeable\"));\n\nvar _mixins = _interopRequireDefault(require(\"../../util/mixins\"));\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction ownKeys(object, enumerableOnly) {\n  var keys = Object.keys(object);\n\n  if (Object.getOwnPropertySymbols) {\n    var symbols = Object.getOwnPropertySymbols(object);\n    if (enumerableOnly) symbols = symbols.filter(function (sym) {\n      return Object.getOwnPropertyDescriptor(object, sym).enumerable;\n    });\n    keys.push.apply(keys, symbols);\n  }\n\n  return keys;\n}\n\nfunction _objectSpread(target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i] != null ? arguments[i] : {};\n\n    if (i % 2) {\n      ownKeys(Object(source), true).forEach(function (key) {\n        _defineProperty(target, key, source[key]);\n      });\n    } else if (Object.getOwnPropertyDescriptors) {\n      Object.defineProperties(target, Object.getOwnPropertyDescriptors(source));\n    } else {\n      ownKeys(Object(source)).forEach(function (key) {\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n      });\n    }\n  }\n\n  return target;\n}\n\nfunction _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nvar _default2 = (0, _mixins.default)(_colorable.default, _themeable.default\n/* @vue/component */\n).extend({\n  name: 'v-time-picker-clock',\n  props: {\n    allowedValues: Function,\n    ampm: Boolean,\n    disabled: Boolean,\n    double: Boolean,\n    format: {\n      type: Function,\n      default: function _default(val) {\n        return val;\n      }\n    },\n    max: {\n      type: Number,\n      required: true\n    },\n    min: {\n      type: Number,\n      required: true\n    },\n    scrollable: Boolean,\n    readonly: Boolean,\n    rotate: {\n      type: Number,\n      default: 0\n    },\n    step: {\n      type: Number,\n      default: 1\n    },\n    value: Number\n  },\n  data: function data() {\n    return {\n      inputValue: this.value,\n      isDragging: false,\n      valueOnMouseDown: null,\n      valueOnMouseUp: null\n    };\n  },\n  computed: {\n    count: function count() {\n      return this.max - this.min + 1;\n    },\n    degreesPerUnit: function degreesPerUnit() {\n      return 360 / this.roundCount;\n    },\n    degrees: function degrees() {\n      return this.degreesPerUnit * Math.PI / 180;\n    },\n    displayedValue: function displayedValue() {\n      return this.value == null ? this.min : this.value;\n    },\n    innerRadiusScale: function innerRadiusScale() {\n      return 0.62;\n    },\n    roundCount: function roundCount() {\n      return this.double ? this.count / 2 : this.count;\n    }\n  },\n  watch: {\n    value: function value(_value) {\n      this.inputValue = _value;\n    }\n  },\n  methods: {\n    wheel: function wheel(e) {\n      e.preventDefault();\n      var delta = Math.sign(-e.deltaY || 1);\n      var value = this.displayedValue;\n\n      do {\n        value = value + delta;\n        value = (value - this.min + this.count) % this.count + this.min;\n      } while (!this.isAllowed(value) && value !== this.displayedValue);\n\n      if (value !== this.displayedValue) {\n        this.update(value);\n      }\n    },\n    isInner: function isInner(value) {\n      return this.double && value - this.min >= this.roundCount;\n    },\n    handScale: function handScale(value) {\n      return this.isInner(value) ? this.innerRadiusScale : 1;\n    },\n    isAllowed: function isAllowed(value) {\n      return !this.allowedValues || this.allowedValues(value);\n    },\n    genValues: function genValues() {\n      var children = [];\n\n      for (var value = this.min; value <= this.max; value = value + this.step) {\n        var color = value === this.value && (this.color || 'accent');\n        children.push(this.$createElement('span', this.setBackgroundColor(color, {\n          staticClass: 'v-time-picker-clock__item',\n          class: {\n            'v-time-picker-clock__item--active': value === this.displayedValue,\n            'v-time-picker-clock__item--disabled': this.disabled || !this.isAllowed(value)\n          },\n          style: this.getTransform(value),\n          domProps: {\n            innerHTML: \"<span>\".concat(this.format(value), \"</span>\")\n          }\n        })));\n      }\n\n      return children;\n    },\n    genHand: function genHand() {\n      var scale = \"scaleY(\".concat(this.handScale(this.displayedValue), \")\");\n      var angle = this.rotate + this.degreesPerUnit * (this.displayedValue - this.min);\n      var color = this.value != null && (this.color || 'accent');\n      return this.$createElement('div', this.setBackgroundColor(color, {\n        staticClass: 'v-time-picker-clock__hand',\n        class: {\n          'v-time-picker-clock__hand--inner': this.isInner(this.value)\n        },\n        style: {\n          transform: \"rotate(\".concat(angle, \"deg) \").concat(scale)\n        }\n      }));\n    },\n    getTransform: function getTransform(i) {\n      var _this$getPosition = this.getPosition(i),\n          x = _this$getPosition.x,\n          y = _this$getPosition.y;\n\n      return {\n        left: \"\".concat(50 + x * 50, \"%\"),\n        top: \"\".concat(50 + y * 50, \"%\")\n      };\n    },\n    getPosition: function getPosition(value) {\n      var rotateRadians = this.rotate * Math.PI / 180;\n      return {\n        x: Math.sin((value - this.min) * this.degrees + rotateRadians) * this.handScale(value),\n        y: -Math.cos((value - this.min) * this.degrees + rotateRadians) * this.handScale(value)\n      };\n    },\n    onMouseDown: function onMouseDown(e) {\n      e.preventDefault();\n      this.valueOnMouseDown = null;\n      this.valueOnMouseUp = null;\n      this.isDragging = true;\n      this.onDragMove(e);\n    },\n    onMouseUp: function onMouseUp(e) {\n      e.stopPropagation();\n      this.isDragging = false;\n\n      if (this.valueOnMouseUp !== null && this.isAllowed(this.valueOnMouseUp)) {\n        this.$emit('change', this.valueOnMouseUp);\n      }\n    },\n    onDragMove: function onDragMove(e) {\n      e.preventDefault();\n      if (!this.isDragging && e.type !== 'click' || !this.$refs.clock) return;\n\n      var _this$$refs$clock$get = this.$refs.clock.getBoundingClientRect(),\n          width = _this$$refs$clock$get.width,\n          top = _this$$refs$clock$get.top,\n          left = _this$$refs$clock$get.left;\n\n      var _this$$refs$innerCloc = this.$refs.innerClock.getBoundingClientRect(),\n          innerWidth = _this$$refs$innerCloc.width;\n\n      var _ref = 'touches' in e ? e.touches[0] : e,\n          clientX = _ref.clientX,\n          clientY = _ref.clientY;\n\n      var center = {\n        x: width / 2,\n        y: -width / 2\n      };\n      var coords = {\n        x: clientX - left,\n        y: top - clientY\n      };\n      var handAngle = Math.round(this.angle(center, coords) - this.rotate + 360) % 360;\n      var insideClick = this.double && this.euclidean(center, coords) < (innerWidth + innerWidth * this.innerRadiusScale) / 4;\n      var checksCount = Math.ceil(15 / this.degreesPerUnit);\n      var value;\n\n      for (var i = 0; i < checksCount; i++) {\n        value = this.angleToValue(handAngle + i * this.degreesPerUnit, insideClick);\n        if (this.isAllowed(value)) return this.setMouseDownValue(value);\n        value = this.angleToValue(handAngle - i * this.degreesPerUnit, insideClick);\n        if (this.isAllowed(value)) return this.setMouseDownValue(value);\n      }\n    },\n    angleToValue: function angleToValue(angle, insideClick) {\n      var value = (Math.round(angle / this.degreesPerUnit) + (insideClick ? this.roundCount : 0)) % this.count + this.min; // Necessary to fix edge case when selecting left part of the value(s) at 12 o'clock\n\n      if (angle < 360 - this.degreesPerUnit / 2) return value;\n      return insideClick ? this.max - this.roundCount + 1 : this.min;\n    },\n    setMouseDownValue: function setMouseDownValue(value) {\n      if (this.valueOnMouseDown === null) {\n        this.valueOnMouseDown = value;\n      }\n\n      this.valueOnMouseUp = value;\n      this.update(value);\n    },\n    update: function update(value) {\n      if (this.inputValue !== value) {\n        this.inputValue = value;\n        this.$emit('input', value);\n      }\n    },\n    euclidean: function euclidean(p0, p1) {\n      var dx = p1.x - p0.x;\n      var dy = p1.y - p0.y;\n      return Math.sqrt(dx * dx + dy * dy);\n    },\n    angle: function angle(center, p1) {\n      var value = 2 * Math.atan2(p1.y - center.y - this.euclidean(center, p1), p1.x - center.x);\n      return Math.abs(value * 180 / Math.PI);\n    }\n  },\n  render: function render(h) {\n    var _this = this;\n\n    var data = {\n      staticClass: 'v-time-picker-clock',\n      class: _objectSpread({\n        'v-time-picker-clock--indeterminate': this.value == null\n      }, this.themeClasses),\n      on: this.readonly || this.disabled ? undefined : {\n        mousedown: this.onMouseDown,\n        mouseup: this.onMouseUp,\n        mouseleave: function mouseleave(e) {\n          return _this.isDragging && _this.onMouseUp(e);\n        },\n        touchstart: this.onMouseDown,\n        touchend: this.onMouseUp,\n        mousemove: this.onDragMove,\n        touchmove: this.onDragMove\n      },\n      ref: 'clock'\n    };\n\n    if (this.scrollable && data.on) {\n      data.on.wheel = this.wheel;\n    }\n\n    return h('div', data, [h('div', {\n      staticClass: 'v-time-picker-clock__inner',\n      ref: 'innerClock'\n    }, [this.genHand(), this.genValues()])]);\n  }\n});\n\nexports.default = _default2;","map":{"version":3,"mappings":"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","names":["require","_colorable","_themeable","extend","name","props","allowedValues","Function","ampm","Boolean","disabled","double","format","type","default","val","max","Number","required","min","scrollable","readonly","rotate","step","value","data","inputValue","isDragging","valueOnMouseDown","valueOnMouseUp","computed","count","degreesPerUnit","roundCount","degrees","Math","PI","displayedValue","innerRadiusScale","watch","_value","methods","wheel","e","preventDefault","delta","sign","deltaY","isAllowed","update","isInner","handScale","genValues","children","color","push","$createElement","setBackgroundColor","staticClass","class","style","getTransform","domProps","innerHTML","genHand","scale","angle","transform","i","getPosition","x","y","left","top","rotateRadians","sin","cos","onMouseDown","onDragMove","onMouseUp","stopPropagation","$emit","$refs","clock","getBoundingClientRect","width","innerClock","innerWidth","touches","clientX","clientY","center","coords","handAngle","round","insideClick","euclidean","checksCount","ceil","angleToValue","setMouseDownValue","p0","p1","dx","dy","sqrt","atan2","abs","render","h","themeClasses","on","undefined","mousedown","mouseup","mouseleave","_this","touchstart","touchend","mousemove","touchmove","ref"],"sourceRoot":"","sources":["../../../src/components/VTimePicker/VTimePickerClock.ts"],"sourcesContent":["import './VTimePickerClock.sass'\n\n// Mixins\nimport Colorable from '../../mixins/colorable'\nimport Themeable from '../../mixins/themeable'\n\n// Types\nimport mixins, { ExtractVue } from '../../util/mixins'\nimport Vue, { VNode, PropType, VNodeData } from 'vue'\nimport { PropValidator } from 'vue/types/options'\n\ninterface Point {\n  x: number\n  y: number\n}\n\ninterface options extends Vue {\n  $refs: {\n    clock: HTMLElement\n    innerClock: HTMLElement\n  }\n}\n\nexport default mixins<options &\n/* eslint-disable indent */\n  ExtractVue<[\n    typeof Colorable,\n    typeof Themeable\n  ]>\n/* eslint-enable indent */\n>(\n  Colorable,\n  Themeable\n/* @vue/component */\n).extend({\n  name: 'v-time-picker-clock',\n\n  props: {\n    allowedValues: Function as PropType<(value: number) => boolean>,\n    ampm: Boolean,\n    disabled: Boolean,\n    double: Boolean,\n    format: {\n      type: Function,\n      default: (val: string | number) => val,\n    } as PropValidator<(val: string | number) => string | number>,\n    max: {\n      type: Number,\n      required: true,\n    },\n    min: {\n      type: Number,\n      required: true,\n    },\n    scrollable: Boolean,\n    readonly: Boolean,\n    rotate: {\n      type: Number,\n      default: 0,\n    },\n    step: {\n      type: Number,\n      default: 1,\n    },\n    value: Number,\n  },\n\n  data () {\n    return {\n      inputValue: this.value,\n      isDragging: false,\n      valueOnMouseDown: null as number | null,\n      valueOnMouseUp: null as number | null,\n    }\n  },\n\n  computed: {\n    count (): number {\n      return this.max - this.min + 1\n    },\n    degreesPerUnit (): number {\n      return 360 / this.roundCount\n    },\n    degrees (): number {\n      return this.degreesPerUnit * Math.PI / 180\n    },\n    displayedValue (): number {\n      return this.value == null ? this.min : this.value\n    },\n    innerRadiusScale (): number {\n      return 0.62\n    },\n    roundCount (): number {\n      return this.double ? (this.count / 2) : this.count\n    },\n  },\n\n  watch: {\n    value (value) {\n      this.inputValue = value\n    },\n  },\n\n  methods: {\n    wheel (e: WheelEvent) {\n      e.preventDefault()\n\n      const delta = Math.sign(-e.deltaY || 1)\n      let value = this.displayedValue\n      do {\n        value = value + delta\n        value = (value - this.min + this.count) % this.count + this.min\n      } while (!this.isAllowed(value) && value !== this.displayedValue)\n\n      if (value !== this.displayedValue) {\n        this.update(value)\n      }\n    },\n    isInner (value: number) {\n      return this.double && (value - this.min >= this.roundCount)\n    },\n    handScale (value: number) {\n      return this.isInner(value) ? this.innerRadiusScale : 1\n    },\n    isAllowed (value: number) {\n      return !this.allowedValues || this.allowedValues(value)\n    },\n    genValues () {\n      const children: VNode[] = []\n\n      for (let value = this.min; value <= this.max; value = value + this.step) {\n        const color = value === this.value && (this.color || 'accent')\n        children.push(this.$createElement('span', this.setBackgroundColor(color, {\n          staticClass: 'v-time-picker-clock__item',\n          class: {\n            'v-time-picker-clock__item--active': value === this.displayedValue,\n            'v-time-picker-clock__item--disabled': this.disabled || !this.isAllowed(value),\n          },\n          style: this.getTransform(value),\n          domProps: { innerHTML: `<span>${this.format(value)}</span>` },\n        })))\n      }\n\n      return children\n    },\n    genHand () {\n      const scale = `scaleY(${this.handScale(this.displayedValue)})`\n      const angle = this.rotate + this.degreesPerUnit * (this.displayedValue - this.min)\n      const color = (this.value != null) && (this.color || 'accent')\n      return this.$createElement('div', this.setBackgroundColor(color, {\n        staticClass: 'v-time-picker-clock__hand',\n        class: {\n          'v-time-picker-clock__hand--inner': this.isInner(this.value),\n        },\n        style: {\n          transform: `rotate(${angle}deg) ${scale}`,\n        },\n      }))\n    },\n    getTransform (i: number) {\n      const { x, y } = this.getPosition(i)\n      return {\n        left: `${50 + x * 50}%`,\n        top: `${50 + y * 50}%`,\n      }\n    },\n    getPosition (value: number) {\n      const rotateRadians = this.rotate * Math.PI / 180\n      return {\n        x: Math.sin((value - this.min) * this.degrees + rotateRadians) * this.handScale(value),\n        y: -Math.cos((value - this.min) * this.degrees + rotateRadians) * this.handScale(value),\n      }\n    },\n    onMouseDown (e: MouseEvent | TouchEvent) {\n      e.preventDefault()\n\n      this.valueOnMouseDown = null\n      this.valueOnMouseUp = null\n      this.isDragging = true\n      this.onDragMove(e)\n    },\n    onMouseUp (e: MouseEvent | TouchEvent) {\n      e.stopPropagation()\n\n      this.isDragging = false\n      if (this.valueOnMouseUp !== null && this.isAllowed(this.valueOnMouseUp)) {\n        this.$emit('change', this.valueOnMouseUp)\n      }\n    },\n    onDragMove (e: MouseEvent | TouchEvent) {\n      e.preventDefault()\n      if ((!this.isDragging && e.type !== 'click') || !this.$refs.clock) return\n\n      const { width, top, left } = this.$refs.clock.getBoundingClientRect()\n      const { width: innerWidth } = this.$refs.innerClock.getBoundingClientRect()\n      const { clientX, clientY } = 'touches' in e ? e.touches[0] : e\n      const center = { x: width / 2, y: -width / 2 }\n      const coords = { x: clientX - left, y: top - clientY }\n      const handAngle = Math.round(this.angle(center, coords) - this.rotate + 360) % 360\n      const insideClick = this.double && this.euclidean(center, coords) < (innerWidth + innerWidth * this.innerRadiusScale) / 4\n      const checksCount = Math.ceil(15 / this.degreesPerUnit)\n      let value\n\n      for (let i = 0; i < checksCount; i++) {\n        value = this.angleToValue(handAngle + i * this.degreesPerUnit, insideClick)\n        if (this.isAllowed(value)) return this.setMouseDownValue(value)\n\n        value = this.angleToValue(handAngle - i * this.degreesPerUnit, insideClick)\n        if (this.isAllowed(value)) return this.setMouseDownValue(value)\n      }\n    },\n    angleToValue (angle: number, insideClick: boolean): number {\n      const value = (\n        Math.round(angle / this.degreesPerUnit) +\n        (insideClick ? this.roundCount : 0)\n      ) % this.count + this.min\n\n      // Necessary to fix edge case when selecting left part of the value(s) at 12 o'clock\n      if (angle < (360 - this.degreesPerUnit / 2)) return value\n\n      return insideClick ? this.max - this.roundCount + 1 : this.min\n    },\n    setMouseDownValue (value: number) {\n      if (this.valueOnMouseDown === null) {\n        this.valueOnMouseDown = value\n      }\n\n      this.valueOnMouseUp = value\n      this.update(value)\n    },\n    update (value: number) {\n      if (this.inputValue !== value) {\n        this.inputValue = value\n        this.$emit('input', value)\n      }\n    },\n    euclidean (p0: Point, p1: Point) {\n      const dx = p1.x - p0.x\n      const dy = p1.y - p0.y\n\n      return Math.sqrt(dx * dx + dy * dy)\n    },\n    angle (center: Point, p1: Point) {\n      const value = 2 * Math.atan2(p1.y - center.y - this.euclidean(center, p1), p1.x - center.x)\n      return Math.abs(value * 180 / Math.PI)\n    },\n  },\n\n  render (h): VNode {\n    const data: VNodeData = {\n      staticClass: 'v-time-picker-clock',\n      class: {\n        'v-time-picker-clock--indeterminate': this.value == null,\n        ...this.themeClasses,\n      },\n      on: (this.readonly || this.disabled) ? undefined : {\n        mousedown: this.onMouseDown,\n        mouseup: this.onMouseUp,\n        mouseleave: (e: MouseEvent) => (this.isDragging && this.onMouseUp(e)),\n        touchstart: this.onMouseDown,\n        touchend: this.onMouseUp,\n        mousemove: this.onDragMove,\n        touchmove: this.onDragMove,\n      },\n      ref: 'clock',\n    }\n\n    if (this.scrollable && data.on) {\n      data.on.wheel = this.wheel\n    }\n\n    return h('div', data, [\n      h('div', {\n        staticClass: 'v-time-picker-clock__inner',\n        ref: 'innerClock',\n      }, [\n        this.genHand(),\n        this.genValues(),\n      ]),\n    ])\n  },\n})\n"]},"metadata":{},"sourceType":"script"}